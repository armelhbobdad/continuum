name: Privacy Gate

on:
  push:
    branches: [main, dev]
  pull_request:
    branches: [main, dev]

jobs:
  privacy-gate:
    name: Privacy Gate Tests
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build privacy test image
        run: docker build -f Dockerfile.privacy-test -t privacy-runner .

      - name: Run privacy tests (network isolated)
        run: |
          # Run tests with --network none to guarantee no network access
          # Any network call will cause immediate test failure
          docker run --network none privacy-runner

      - name: Verify isolation
        run: |
          echo "Privacy gate tests passed with network isolation"
          echo "All tests ran without any network access"
